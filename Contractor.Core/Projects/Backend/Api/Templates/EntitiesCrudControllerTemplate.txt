using Contract.Architecture.Backend.Common.API;
using Contract.Architecture.Backend.Common.Contract.Logic;
using ProjectName.API.Security.Authorization;
using ProjectName.Contract.Logic.Modules.Domain.Entities;
using Microsoft.AspNetCore.Mvc;
using System;
using System.Collections.Generic;
using Swashbuckle.AspNetCore.Annotations;

namespace ProjectName.API.Modules.Domain.Entities
{
    [ApiController]
    [Route("domain-kebab/entities-kebab")]
    public class EntitiesCrudController : ControllerBase
    {
        private readonly IEntitiesCrudLogic entitiesCrudLogic;

        public EntitiesCrudController(IEntitiesCrudLogic entitiesCrudLogic)
        {
            this.entitiesCrudLogic = entitiesCrudLogic;
        }

        [HttpGet]
        [Authorized]
        [SwaggerOperation(Summary = "Get EntitiesReadable with Pagination", Tags = new[] { "Domain" })]
        [Pagination(FilterFields = new[] { "DisplayProperty" }, SortFields = new[] { "DisplayProperty" })]
        public ActionResult<IPagedResult<IEntityListItem>> GetPagedEntities()
        {
            return this.Ok(this.entitiesCrudLogic.GetPagedEntities());
        }

        [HttpGet]
        [Authorized]
        [Route("{entityId}")]
        [SwaggerOperation(Summary = "Get EntityReadable by Id", Tags = new[] { "Domain" })]
        public ActionResult<IEntityDetail> GetEntityDetail(Guid entityId)
        {
            return this.Ok(this.entitiesCrudLogic.GetEntityDetail(entityId));
        }

        [HttpPost]
        [Authorized]
        [SwaggerOperation(Summary = "Create EntityReadable", Tags = new[] { "Domain" })]
        public ActionResult<DataBody<Guid>> CreateEntity([FromBody] EntityCreate entityCreate)
        {
            return this.Ok(new DataBody<Guid>(this.entitiesCrudLogic.CreateEntity(entityCreate)));
        }

        [HttpPut]
        [Authorized]
        [SwaggerOperation(Summary = "Update EntityReadable", Tags = new[] { "Domain" })]
        public ActionResult UpdateEntity([FromBody] EntityUpdate entityUpdate)
        {
            this.entitiesCrudLogic.UpdateEntity(entityUpdate);
            return this.Ok();
        }

        [HttpDelete]
        [Authorized]
        [Route("{entityId}")]
        [SwaggerOperation(Summary = "Delete EntityReadable by Id", Tags = new[] { "Domain" })]
        public ActionResult DeleteEntity(Guid entityId)
        {
            this.entitiesCrudLogic.DeleteEntity(entityId);
            return this.Ok();
        }
    }
}